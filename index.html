<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- For Mobile Devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta name="generator" content="Doxygen 1.8.6"/>
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <link rel="stylesheet" href='http://fonts.googleapis.com/css?family=Exo+2:400,200,700' type='text/css'>
    <title>LCS: Documentation</title>
    <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
    <link href="main.css" rel="stylesheet" type="text/css" />
    <!--  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css"> -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="doxy-boot.js"></script>
    <script type="text/javascript" src="bootstrap-hover-dropdown.min.js"></script>
</head>
<body>
<!-- HERE STARTS THE NAVIGATION BAR (as in the index.html web site generated with bootstrap) -->
    <nav class="navbar navbar-default role="navigation">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="https://github.com/stevenliuyi/lcs/">
              <span class="logo first">PROJECT</span>
              <span class="logo second">LCS</span>
          </a>
        </div>
        <div class="navbar-collapse collapse">
            <p class="navbar-text">Lagrangian coherent structure analysis</p> 
            <p class="navbar-text navbar-right">
                <a href="https://github.com/stevenliuyi/lcs">
                    <img src="GitHub-Mark-Light-32px.png" width="24">
                </a>
            </p>
        </div><!--/.navbar-collapse -->
      </div>
    </nav>
<!-- HERE ENDS THE NAVIGATION BAR -->
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div class="content" id="content">
        <div class="container">
            <div class="row">
                <div class="col-sm-12 panel panel-default" style="padding-bottom: 15px;">
                    <div style="margin-bottom: 15px;">
                        <!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Documentation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="el" href="namespace_l_c_s.html" title="Namespace for the whole project. ">LCS</a> is a library for performing <a href="https://en.wikipedia.org/wiki/Lagrangian_coherent_structure">Lagrangian coherent structure</a> (<a class="el" href="namespace_l_c_s.html" title="Namespace for the whole project. ">LCS</a>) analysis of flow field. <a href="http://www.openmp.org/">OpenMP</a> is supported for parallelization.</p>
<p>It implements particle advection calculations for both discrete and continuous flow velocity data, and then uses finite-time Lyapunov exponent technique to obtain LCSs.</p>
<p>Suppose we have the flow map <img class="formulaInl" alt="$\phi(t_0+T,\mathbf{x}_0,t_0)$" src="form_25.png"/> obtained after fluid particle advection, where <img class="formulaInl" alt="$\mathbf{x}_0$" src="form_26.png"/> and <img class="formulaInl" alt="$t_0$" src="form_27.png"/> are intial particle position and time, and <img class="formulaInl" alt="$T$" src="form_28.png"/> is the advection time (integration time). Then, FTLE is defined as</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ FTLE(\mathbf{x}_0,t_0) =\frac{1}{2T}\log\Big\{\lambda_{\max}\Big[\Big(\frac{\partial\phi}{\partial\mathbf{x}_0}\Big)^T\Big(\frac{\partial\phi}{\partial\mathbf{x}_0}\Big)\Big]\Big\}, \]" src="form_29.png"/>
</p>
<p>where <img class="formulaInl" alt="$\lambda_{\max}$" src="form_30.png"/> denotes the maximum eigenvalue of a matrix. Here, the matrix is called Cauchy-Green tensor.</p>
<h2>Installation and Running</h2>
<p>First, clone the repository from Gitub and enter the repository folder:</p>
<div class="fragment"><div class="line">git clone https:<span class="comment">//github.com/stevenliuyi/lcs</span></div>
<div class="line">cd lcs</div>
</div><!-- fragment --><p>Please make sure that your compiler supports C++14 standard, and then compile the program:</p>
<div class="fragment"><div class="line">make</div>
</div><!-- fragment --><p>The compiled programs will be in the <code>bin</code> folder. There are two demo programs <code>demo_continuous_double_gyre</code> and <code>demo_discrete_double_gyre</code>, for continous and discrete data respectively. Please refer to the examples below for more details. You could run the program as:</p>
<div class="fragment"><div class="line">bin/demo_continuous_double_gyre</div>
</div><!-- fragment --><p>If you'd like to change the threads for OpenMP, you could set the environment variable <code>OMP_NUM_THREADS</code>.</p>
<p>The demo result files are <code>double_gyre_ftle_pos.txt</code> and <code>double_gyre_ftle_neg.txt</code>, for positive FTLE (forward advection) and negative FTLE (backward advection) respectively.</p>
<h3>Plotting</h3>
<p>There is no graphics support in the program, but you could easily make plots in other programs with the result data files. For example, the contour FTLE plots below shown in the examples can be easily generated in python as:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;import numpy <span class="keyword">as</span> np</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;ftle = np.genfromtxt(<span class="stringliteral">&#39;double_gyre_ftle_neg.txt&#39;</span>, skip_header=3).reshape((1000,500))</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;x = np.linspace(0,2,num=1000)</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;y = np.linspace(0,1,num=500)</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;X, Y = np.meshgrid(x, y, indexing=<span class="stringliteral">&#39;ij&#39;</span>)</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;plt.contourf(X, Y, ftle, 100, cmap=plt.cm.Reds)</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;plt.show()</div>
</div><!-- fragment --><h2>Examples</h2>
<h3>Continuous data</h3>
<p>Here we show a demo of perform FTLE calculation for a double-gyre model. The implementation is included in <a class="el" href="continuous__double__gyre_8cpp.html" title="Demo for FTLE calculation of continuous double-gyre model. ">continuous_double_gyre.cpp</a>.</p>
<table class="doxtable">
<tr>
<th>pFTLE </th><th>nFTLE  </th></tr>
<tr>
<td><div class="image">
<img src="https://raw.githubusercontent.com/stevenliuyi/lcs/master/demo/double_gyre/continuous_double_gyre_ftle_pos.png"  alt="pFTLE"/>
</div>
 </td><td><div class="image">
<img src="https://raw.githubusercontent.com/stevenliuyi/lcs/master/demo/double_gyre/continuous_double_gyre_ftle_neg.png"  alt="nFTLE"/>
</div>
 </td></tr>
</table>
<p>First, we create a ContinuousFlowField object, and set the grid shape as <img class="formulaInl" alt="$(1000,500)$" src="form_31.png"/>, the range of <img class="formulaInl" alt="$x$" src="form_2.png"/>-coordinate as <img class="formulaInl" alt="$(0,2)$" src="form_32.png"/>, and the range of <img class="formulaInl" alt="$y$" src="form_3.png"/>-coordinate as <img class="formulaInl" alt="$(0,1)$" src="form_33.png"/>. Note that this is a 2D flow field, so we should set the dimension to be 2 for the object.</p>
<div class="fragment"><div class="line">ContinuousFlowField&lt;double,VelocityFunction::DoubleGyreModel&lt;double&gt;,2&gt; double_gyre(1000,500);</div>
<div class="line">double_gyre.InitialPosition().SetAll(0,2,0,1);</div>
</div><!-- fragment --><p>Next, we set each integration time step as <img class="formulaInl" alt="$\Delta t=0.1$" src="form_34.png"/>, and the number of steps as <img class="formulaInl" alt="$n=200$" src="form_35.png"/>:</p>
<div class="fragment"><div class="line">double_gyre.SetDelta(.1);</div>
<div class="line">double_gyre.SetStep(200);</div>
</div><!-- fragment --><p>Now we have done all the settings, and we could then simply advect the particles to obtain the flow map:</p>
<div class="fragment"><div class="line">double_gyre.Run();</div>
</div><!-- fragment --><p>Finally, we could calculate FTLE based on the flow map we just obtained:</p>
<div class="fragment"><div class="line">FTLE&lt;douuble,2&gt; ftle(double_gyre);</div>
<div class="line">ftle.Calculate();</div>
<div class="line">ftle.WriteToFile(<span class="stringliteral">&quot;double_gyre_ftle_pos.txt&quot;</span>);</div>
</div><!-- fragment --><p>If we would like to obtain the flow map in backward direction and then calculate the negative FTLE corresponding to it, we could simply flip the advect direction and redo the calculations as:</p>
<div class="fragment"><div class="line">double_gyre.SetDirection(<a class="code" href="namespace_l_c_s.html#a29a79a797248330fdb006f46542174e7a5dcf40d8a29f7909004f7adbf96101cf">Direction::Backward</a>);</div>
<div class="line">double_gyre.SetInitialTime(20);</div>
<div class="line">double_gyre.Run();</div>
<div class="line"></div>
<div class="line">ftle.Calculate();</div>
<div class="line">ftle.WriteToFile(<span class="stringliteral">&quot;double_gyre_ftle_neg.txt&quot;</span>);</div>
</div><!-- fragment --><h3>Discrete data</h3>
<p>Normally, discrete velocity data are obtained from experiments or CFD simulations. But here we will use the discrete data genereted by the analytic velocity function in the above example, so we could directly compare the results.</p>
<p>The implementation is included in <a class="el" href="discrete__double__gyre_8cpp.html" title="Demo for FTLE calculation of discrete double-gyre model. ">discrete_double_gyre.cpp</a>.</p>
<table class="doxtable">
<tr>
<th>pFTLE </th><th>nFTLE  </th></tr>
<tr>
<td><div class="image">
<img src="https://raw.githubusercontent.com/stevenliuyi/lcs/master/demo/double_gyre/discrete_double_gyre_ftle_pos.png"  alt="pFTLE"/>
</div>
 </td><td><div class="image">
<img src="https://raw.githubusercontent.com/stevenliuyi/lcs/master/demo/double_gyre/discrete_double_gyre_ftle_neg.png"  alt="nFTLE"/>
</div>
 </td></tr>
</table>
<p>First, we use the double-gyre velocity function to generete velocity data at <img class="formulaInl" alt="$t=0,1,2,\cdots 20$" src="form_36.png"/> with 100 grid points in <img class="formulaInl" alt="$x$" src="form_2.png"/>-direction and 50 grid points in <img class="formulaInl" alt="$y$" src="form_3.png"/>-direction.</p>
<div class="fragment"><div class="line">Position&lt;double,2&gt; pos(100,50);</div>
<div class="line">pos.SetAll(0,2,0,1);</div>
<div class="line">ContinuousVelocity&lt;double, VelocityFunction::DoubleGyreModel&lt;double&gt;,2&gt; double_gyre_vel(100,50,pos);</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> t=0; t &lt;= 20; ++t)</div>
<div class="line">{</div>
<div class="line">    std::stringstream ss;</div>
<div class="line">    ss &lt;&lt; <span class="stringliteral">&quot;double_gyre_&quot;</span> &lt;&lt; t &lt;&lt; <span class="stringliteral">&quot;.txt&quot;</span>;</div>
<div class="line">    double_gyre_vel.UpdateTime(t);</div>
<div class="line">    double_gyre_vel.SetAll();</div>
<div class="line">    double_gyre_vel.WriteToFile(ss.str());</div>
<div class="line">}</div>
</div><!-- fragment --><p>Next, we create a DiscreteFlowField object with the same grid shape and <img class="formulaInl" alt="$x$" src="form_2.png"/>-, <img class="formulaInl" alt="$y$" src="form_3.png"/>-range as in the continuous data example. Note that we also need to set the grid shape of the velocity data to be <img class="formulaInl" alt="$(100,50)$" src="form_37.png"/>, as we defined above.</p>
<div class="fragment"><div class="line">DiscreteFlowField&lt;double,2&gt; double_gyre(1000,500,100,50);</div>
<div class="line">double_gyre.DataPosition().SetAll(0,2,0,1);</div>
<div class="line">double_gyre.InitialPosition().SetAll(0,2,0,1);</div>
</div><!-- fragment --><p>To correctly read the velocity data, we also need to define the format of the file names:</p>
<div class="fragment"><div class="line">double_gyre.SetVelocityFileNamePrefix(<span class="stringliteral">&quot;double_gyre_&quot;</span>);</div>
</div><!-- fragment --><p>Now we can set the integration time step and the number of steps as before, but for discrete data, we also need to set the time step between two adjacent data files, as well as the total time range all data files cover:</p>
<div class="fragment"><div class="line">double_gyre.SetDataDelta(1);</div>
<div class="line">double_gyre.SetDataTimeRange(0,20);</div>
<div class="line">double_gyre.SetDelta(.1);</div>
<div class="line">double_gyre.SetStep(200);</div>
</div><!-- fragment --><p>Now we can advect the particles and calculate FTLE:</p>
<div class="fragment"><div class="line">double_gyre.Run();</div>
<div class="line">FTLE&lt;douuble,2&gt; ftle(double_gyre);</div>
<div class="line">ftle.Calculate();</div>
<div class="line">ftle.WriteToFile(<span class="stringliteral">&quot;double_gyre_ftle_pos.txt&quot;</span>);</div>
</div><!-- fragment --><p>We can also calculate negative FTLE the same way as we did in the continous data example. </p>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<div id="footer">
  <div class="container narrow row-fluid">
    <div class="row">
      <div class="col-md-4 col-xs-4 text-left">
		<small>
        <p class=""></p>
		</small>
      </div>
      <div class="col-md-4 col-xs-4 text-center">
          <small>
            <p class="">Yi Liu 2017&nbsp;&nbsp;&nbsp;<a href="mailto:stevenliuyi@gmail.com"><span class="glyphicon glyphicon-envelope glyphicon-white"></span></a></p>
          </small>
      </div>
	  <div class="col-md-4 col-xs-4 text-right">
		<small>
            <p class="">Generated by <a href="http://www.doxygen.org/index.html">doxygen</a> 1.8.6 .</p>
        </small>
      </div>
    </div> <!-- row -->
  </div> <!-- container -->
</div> <!-- footer -->
</body>
</html>
